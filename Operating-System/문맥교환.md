## 문맥 교환 (Context Switch)

### 문맥 교환이란?

- 운영체제가 현재 실행 중인 프로세스나 스레드의 상태(문맥)를 저장하고, 다른 프로세스나 스레드의 상태를 복원하여 실행을 전환하는 과정

<br>

### 왜 문맥 교환이 필요할까?

- 멀티태스킹 환경에서는 여러 프로세스가 CPU를 번갈아 사용해야 한다.
- 한 프로세스를 중단하고 다른 프로세스를 실행하려면
  - 중단되는 프로세스의 상태를 저장하고
  - 새로 실행할 프로세스의 이전 상태를 복원해야 한다.
- 이 상태 저장과 복원의 과정을 문맥 교환이라고 한다.

<br>

### 문맥(Context)에 포함되는 정보

| 항목               | 설명                              |
|--------------------|-----------------------------------|
| 레지스터 값         | 계산 도중인 값들                   |
| 프로그램 카운터(PC) | 다음에 실행할 명령어의 주소          |
| 스택 포인터         | 함수 호출 및 지역 변수 처리를 위한 스택 위치 |
| 메모리 관리 정보     | 페이지 테이블 등 메모리 관련 정보     |
| 프로세스 상태       | Ready, Running 등 현재 상태 정보     |

<br>

### 문맥 교환의 단점

- 문맥 교환에는 저장 및 복원 작업이 필요하므로 시간과 자원이 소모된다.
- 너무 자주 문맥 교환이 발생하면 시스템 성능이 저하될 수 있는데, 이를 **오버헤드(overhead)**라고 한다.

<br>

### 예시

1. 프로세스 P1이 실행 중이다.
2. 타임 슬라이스가 만료되었거나 더 높은 우선순위 프로세스(P2)가 도착한다.
3. 운영체제는 P1의 상태를 저장한다.
4. 운영체제는 P2의 상태를 복원한다.
5. CPU는 P2를 실행하기 시작한다.

→ 이 전체 흐름이 문맥 교환이다.