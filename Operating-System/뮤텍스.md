## 뮤텍스 (Mutex)

### 1. 뮤텍스

뮤텍스(Mutex, Mutual Exclusion)는 **"상호 배제"** 를 의미하며,  
한 번에 **하나의 프로세스(또는 스레드)만 공유 자원에 접근할 수 있도록 하는 동기화 기법**이다.

멀티스레드 또는 멀티프로세스 환경에서 **공유 자원(Shared Resource)** 이 동시에 사용될 경우, 경쟁 상태(Race Condition)로 인해 데이터 무결성이 깨질 수 있다.  
이를 방지하기 위해 **뮤텍스는 특정 프로세스(또는 스레드)만이 자원에 접근할 수 있도록 잠금(Lock)과 해제(Unlock) 메커니즘을 제공한다.**

<br>

### 2. 뮤텍스의 동작 방식

뮤텍스는 **Lock(획득)과 Unlock(해제) 연산**을 통해 동작한다.

#### 1) Lock (획득)
- 특정 스레드(또는 프로세스)가 뮤텍스를 획득하면, 다른 스레드는 해당 자원에 접근할 수 없다.
- 자원이 사용 중이면 다른 스레드는 **대기 상태**로 전환된다.

#### 2) Unlock (해제)
- 뮤텍스를 소유한 스레드(또는 프로세스)가 작업을 마치면, 자원을 해제하여 대기 중인 다른 스레드가 접근할 수 있도록 한다.

#### 3) 뮤텍스의 동작 흐름
1. 여러 스레드(또는 프로세스)가 공유 자원에 접근을 시도한다.
2. 하나의 스레드가 뮤텍스를 **Lock(획득)** 하여 자원을 독점적으로 사용한다.
3. 나머지 스레드는 **Lock이 해제될 때까지 대기 상태**로 유지된다.
4. 자원 사용이 끝나면 **Unlock(해제)** 하여 다른 스레드가 자원을 사용할 수 있도록 한다.

<br>

### 3. 뮤텍스 vs 세마포어

| 비교 항목 | 뮤텍스 (Mutex) | 세마포어 (Semaphore) |
|----------|---------------|----------------------|
| 개수 | 1개 (Binary Semaphore) | N개까지 가능 |
| 공유 방식 | 한 프로세스 내에서만 사용 | 프로세스 간 공유 가능 |
| 사용 목적 | 단 하나의 스레드만 접근 허용 | 일정 개수의 스레드/프로세스 제한 |
| 소유권 | 소유권 있음 (Lock을 건 스레드만 해제 가능) | 소유권 없음 (누구나 해제 가능) |

뮤텍스는 **한 번에 하나의 스레드만 공유 자원에 접근할 수 있도록 제한** 하는 반면,  
세마포어는 **여러 개의 프로세스(또는 스레드)가 동시에 접근 가능하도록 개수를 조절**할 수 있다.

<br>

### 4. 운영체제에서 뮤텍스의 역할

#### 1) 상호 배제 (Mutual Exclusion)
- 뮤텍스를 사용하면 한 번에 하나의 프로세스(또는 스레드)만 공유 자원에 접근할 수 있다.
- 이를 통해 공유 데이터의 **일관성과 무결성** 을 유지할 수 있다.

#### 2) 경쟁 상태(Race Condition) 방지
- 여러 개의 스레드가 동시에 데이터를 수정하면, 데이터가 불완전한 상태가 될 수 있다.
- 뮤텍스를 사용하면 한 번에 하나의 스레드만 접근 가능하므로, **경쟁 상태를 방지**할 수 있다.

#### 3) 교착 상태 (Deadlock) 방지
- 뮤텍스를 잘못 사용하면, 서로 뮤텍스를 점유하고 대기하는 **교착 상태(Deadlock)** 가 발생할 수 있다.
- 이를 방지하기 위해, 운영체제에서는 **뮤텍스 사용 순서 지정, 타임아웃 설정** 등의 기법을 사용한다.

<br>

### 5. 뮤텍스가 사용되는 예시

- 파일 시스템에서 파일 보호 (한 번에 하나의 프로세스만 파일 수정 가능)
- 은행 계좌 트랜잭션 보호 (동시에 여러 요청이 처리되지 않도록 제한)
- 멀티스레드 프로그래밍에서 공유 메모리 보호
- 운영체제의 커널 데이터 보호 (한 번에 하나의 프로세스만 접근 가능)

<br>

### 6. 정리

- 뮤텍스는 단일 공유 자원에 대해 상호 배제를 보장하는 동기화 기법이다.
- Lock(획득)과 Unlock(해제) 연산을 사용하여 하나의 스레드만 자원에 접근할 수 있도록 제한한다.
- 경쟁 상태(Race Condition)를 방지하고, 공유 데이터의 일관성을 유지할 수 있도록 한다.
- 세마포어와 달리, 뮤텍스는 한 번에 하나의 프로세스(또는 스레드)만 접근 가능하며 소유권이 존재한다.

<br>

### 7. 언제 뮤텍스를 사용해야 할까?

- 한 번에 하나의 프로세스(또는 스레드)만 공유 자원에 접근해야 하는 경우
- 특정 데이터의 무결성과 일관성을 보장해야 하는 경우
- 여러 개의 프로세스가 동시에 실행되면서 공유 데이터를 변경할 가능성이 있는 경우
- 멀티스레드 환경에서는 뮤텍스가 더 많이 사용되며, 멀티프로세스 환경에서는 세마포어가 더 많이 사용된다.
