## CPU 스케줄링

### 프로세스 우선순위

- **입출력 작업이 많은 프로세스**는 **CPU 작업이 많은 프로세스보다 우선순위가 높다.**
  - 입출력 중심 프로세스는 짧게 실행 후 대기 상태로 넘어가기 때문에, CPU를 오래 점유하지 않으므로 먼저 실행해주는 것이 효율적이다.

<br>

### 스케줄링 큐

- 반드시 FIFO 구조인 것은 아니다.
- 대표적인 큐로는 **준비 큐(Ready Queue)**와 **대기 큐(Waiting Queue)** 등이 있다.

#### 준비 큐 (Ready Queue)
- **CPU를 사용하려는 프로세스들이 줄 서 있는 큐**
- 실행 차례가 끝나거나 타임아웃 인터럽트가 발생하면 다시 이 큐로 돌아온다.

#### 대기 큐 (Waiting Queue)
- **입출력 장치 등의 자원을 기다리는 프로세스들이 줄 서 있는 큐**
- 입출력 작업이 끝나면 다시 준비 큐로 이동한다.
- 동일한 장치를 요구하는 프로세스들은 같은 큐에서 대기한다.

<br>

### 선점형과 비선점형 스케줄링

- 어떤 프로세스가 실행 중일 때, 더 급한 프로세스가 나타났을 때의 처리 방식에 따라 나뉜다.

#### 선점형 스케줄링 (Preemptive Scheduling)
- 현재 CPU를 사용 중인 프로세스로부터 CPU를 **빼앗아** 더 급한 프로세스에게 CPU를 할당한다.
- **장점**: 자원 독점을 방지하고 자원을 고르게 배분할 수 있다.
- **단점**: 문맥 교환(context switch)으로 인한 **오버헤드**가 발생한다.

#### 비선점형 스케줄링 (Non-preemptive Scheduling)
- 현재 실행 중인 프로세스가 CPU 사용을 **스스로 반납할 때까지 기다린다.**
- **장점**: 오버헤드가 적다.
- **단점**: 특정 프로세스가 오래 CPU를 점유할 수 있어 **자원 배분이 불균형**할 수 있다.

<br>

### CPU 스케줄링 알고리즘

1. ### **FCFS (First Come First Served, 선입 선처리 스케줄링)**
   - 준비 큐에 **들어온 순서대로** CPU를 할당.
   - **비선점형** 방식.
   - 단점: 실행 시간이 긴 프로세스가 앞에 있을 경우 호위 효과(convoy effect) 발생 → 전체 대기 시간이 증가.
      - **호위 효과(Convoy Effect)**: 실행 시간이 긴 프로세스 하나 때문에, 짧은 작업을 가진 다른 프로세스들이 오래 기다리게 되는 현상

<br>

2. ### **SJF (Shortest Job First, 최단 작업 우선 스케줄링)**
   - CPU 사용 시간이 **짧은 프로세스**부터 우선 실행.
   - **기본적으로 비선점형**이지만, 선점형으로 구현할 경우 SRT(Shortest Remaining Time)이라고 한다.
   - 단점: 실행 시간을 미리 예측하기 어려움, 기아(starvation) 현상 발생 가능.
      - **기아(starvation) 현상**: 우선순위가 낮거나 자원 획득 우선순위가 낮은 프로세스가 오랫동안 CPU를 할당받지 못해 실행되지 못하는 현상

<br>

3. ### **RR (Round Robin, 라운드 로빈 스케줄링)**
   - FCFS 방식에 **타임 슬라이스(Time Slice)** 개념을 추가.
   - 각 프로세스에 **동일한 시간만큼** CPU 할당, 시간이 지나면 다음 프로세스로 교체.
   - **선점형** 방식.
   - 단점: 타임 슬라이스 크기에 따라 성능 차이 발생.

<br>

4. ### **SRT (Shortest Remaining Time, 최소 잔여 시간 우선 스케줄링)**
   - SJF의 선점형 버전.
   - 새로운 프로세스가 도착했을 때, **남은 실행 시간이 더 짧으면** 현재 실행 중인 프로세스를 중단하고 교체.
   - **선점형** 방식.

<br>

5. ### **Priority Scheduling (우선순위 스케줄링)**
   - 프로세스마다 **우선순위**를 부여하여 높은 순서대로 실행.
   - **비선점형** 또는 **선점형**으로 구현 가능.
   - 단점: **우선순위가 낮은 프로세스는 실행이 계속 지연**되는 기아(starvation) 문제 발생.
   - 해결 방법: **에이징(Aging)** 기법 사용 → 오래 대기한 프로세스의 우선순위를 점진적으로 높임.

<br>

6. ### **MLQ (Multi-Level Queue, 다단계 큐 스케줄링)**
   - **우선순위에 따라 여러 개의 큐**를 사용.
   - 각 큐는 서로 다른 스케줄링 알고리즘을 사용할 수도 있음.
   - **큐 간 이동 불가** → 하위 큐 프로세스는 기아 발생 우려 있음.

<br>

7. ### **MLFQ (Multi-Level Feedback Queue, 다단계 피드백 큐 스케줄링)**
   - MLQ의 단점을 보완한 방식으로, **큐 간 이동 가능**.
   - 새로 준비 상태가 된 프로세스는 **가장 높은 우선순위 큐**에 삽입.
   - 타임 슬라이스를 다 쓰면 **낮은 우선순위 큐로 이동**.
   - **CPU 집중형 프로세스는 우선순위가 점차 낮아지고**, **입출력 중심 프로세스는 높은 우선순위를 유지**하는 효과.

<br>

## CPU 스케줄링 알고리즘 비교

| 알고리즘       | 선점 여부 | 기준                           | 장점                                                       | 단점                                                      | 기아 가능성 | 대표적인 문제 현상     |
|----------------|-----------|--------------------------------|------------------------------------------------------------|------------------------------------------------------------|-------------|--------------------------|
| FCFS           | 비선점형   | 도착 순서                      | 구현이 간단함                                              | 실행 시간이 긴 프로세스가 앞에 있으면 전체 지연됨         | 낮음        | 호위 효과 (Convoy Effect) |
| SJF            | 비선점형   | 실행 시간(예측) 짧은 순        | 평균 대기 시간이 최소가 될 수 있음                         | 실행 시간 예측 어려움, 기아 발생 가능                     | 있음        | 기아 (Starvation)        |
| SRT            | 선점형     | 남은 실행 시간이 가장 짧은 순 | 가장 효율적인 이론적 알고리즘                              | 오버헤드 발생, 실행 시간 정확한 예측 필요                 | 있음        | 기아                     |
| RR             | 선점형     | 시간 할당량(타임 슬라이스)     | 응답 시간이 짧고 공정함                                     | 타임 슬라이스 설정에 따라 성능 차이 큼                    | 낮음        | 문맥 교환 오버헤드       |
| Priority       | 선점형/비선점형 | 우선순위                         | 중요한 작업을 빠르게 처리 가능                              | 낮은 우선순위 프로세스는 실행이 계속 지연될 수 있음       | 있음        | 기아                     |
| MLQ            | 보통 비선점형 | 우선순위 큐                    | 프로세스 특성에 맞는 스케줄링 적용 가능                     | 큐 간 이동 불가, 낮은 큐는 실행 기회 거의 없음            | 있음        | 기아                     |
| MLFQ           | 선점형     | 다단계 우선순위 + 피드백       | 다양한 프로세스에 유연하게 대응, 기아 완화 가능             | 구현 복잡, 적절한 정책 설정 필요                         | 낮음        | 정책 미설정 시 기아 가능 |

